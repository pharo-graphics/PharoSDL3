"
Shader example adapted from https://www.shadertoy.com/view/lldSW4
"
Class {
	#name : 'SDL3MoireShaderSource',
	#superclass : 'SDL3GPURenderStateDemoShaderSource',
	#category : 'SDL3-Tests-Shaders',
	#package : 'SDL3-Tests',
	#tag : 'Shaders'
}

{ #category : 'accessing' }
SDL3MoireShaderSource class >> hlslSource [
	<script: 'self generateEmbeddedSourcesFromHLSL'>

	^ '
Texture2D iChannel0 : register(t0, space2);
SamplerState iChannel0Sampler : register(s0, space2);

cbuffer Params : register(b0, space3)
{
    float iTime;
    float2 iResolution;
}

// Random function dependent on time
float rand(float2 co, float time)
{
    return frac(sin(dot(co.xy, float2(92.0, 80.0))) + 
                cos(dot(co.xy, float2(cos(time) * 41.0, 62.0))) * 2.1);
}

struct PSInput
{
    float4 color : COLOR0;
    float2 uv : TEXCOORD0;
};

float4 main(PSInput input) : SV_Target
{
    // Amount of jitter
    float amt = cos(iTime * 5.0) * 0.01;
    
    // Base UV
    float2 uv = input.uv;
    
    // Calculate random offset
    // Note: The original code calls rand twice with the exact same UVs, 
    // resulting in a diagonal offset (x == y). Replicated here for accuracy.
    float2 rnd = float2(rand(uv, iTime), rand(uv, iTime));
    
    // Sample texture with offset
    float4 color = iChannel0.Sample(iChannel0Sampler, uv + rnd * amt);
    
    return color * input.color;
}
'
]

{ #category : 'accessing' }
SDL3MoireShaderSource class >> sourceCompiledAsDXIL [
	"This method was generated from #hlslSource"

	^ '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' base64Decoded
]

{ #category : 'accessing' }
SDL3MoireShaderSource class >> sourceCompiledAsMSL [
	"This method was generated from #hlslSource"

	^ 'I2luY2x1ZGUgPG1ldGFsX3N0ZGxpYj4KI2luY2x1ZGUgPHNpbWQvc2ltZC5oPgoKdXNpbmcgbmFtZXNwYWNlIG1ldGFsOwoKc3RydWN0IHR5cGVfUGFyYW1zCnsKICAgIGZsb2F0IGlUaW1lOwogICAgcGFja2VkX2Zsb2F0MiBpUmVzb2x1dGlvbjsKfTsKCnN0cnVjdCBtYWluMF9vdXQKewogICAgZmxvYXQ0IG91dF92YXJfU1ZfVGFyZ2V0IFtbY29sb3IoMCldXTsKfTsKCnN0cnVjdCBtYWluMF9pbgp7CiAgICBmbG9hdDQgaW5fdmFyX0NPTE9SMCBbW3VzZXIobG9jbjApXV07CiAgICBmbG9hdDIgaW5fdmFyX1RFWENPT1JEMCBbW3VzZXIobG9jbjEpXV07Cn07CgpmcmFnbWVudCBtYWluMF9vdXQgbWFpbjAobWFpbjBfaW4gaW4gW1tzdGFnZV9pbl1dLCBjb25zdGFudCB0eXBlX1BhcmFtcyYgUGFyYW1zIFtbYnVmZmVyKDApXV0sIHRleHR1cmUyZDxmbG9hdD4gaUNoYW5uZWwwIFtbdGV4dHVyZSgwKV1dLCBzYW1wbGVyIGlDaGFubmVsMFNhbXBsZXIgW1tzYW1wbGVyKDApXV0pCnsKICAgIG1haW4wX291dCBvdXQgPSB7fTsKICAgIG91dC5vdXRfdmFyX1NWX1RhcmdldCA9IGlDaGFubmVsMC5zYW1wbGUoaUNoYW5uZWwwU2FtcGxlciwgKGluLmluX3Zhcl9URVhDT09SRDAgKyAoZmxvYXQyKGZyYWN0KHNpbihkb3QoaW4uaW5fdmFyX1RFWENPT1JEMCwgZmxvYXQyKDkyLjAsIDgwLjApKSkgKyAoY29zKGRvdChpbi5pbl92YXJfVEVYQ09PUkQwLCBmbG9hdDIoY29zKFBhcmFtcy5pVGltZSkgKiA0MS4wLCA2Mi4wKSkpICogMi4wOTk5OTk5MDQ2MzI1NjgzNTkzNzUpKSkgKiAoY29zKFBhcmFtcy5pVGltZSAqIDUuMCkgKiAwLjAwOTk5OTk5OTc3NjQ4MjU4MjA5MjI4NTE1NjI1KSkpKSAqIGluLmluX3Zhcl9DT0xPUjA7CiAgICByZXR1cm4gb3V0Owp9Cgo=' base64Decoded
]

{ #category : 'accessing' }
SDL3MoireShaderSource class >> sourceCompiledAsSPV [
	"This method was generated from #hlslSource"

	^ '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' base64Decoded
]
